# 하드디스크 관리

## 1. 하드디스크 관리

### I. 하드디스크 추가하기

#### 1) 디스크 파티션 작업의 의미

- 파티션이란 물리적 하드디스크를 독립된 영역으로 구분하는 것을 의미
- 디스크 전체를 하나의 파티션으로 사용할수도, 여러 개의 파티션으로 나누어서  사용할 수도 있음
- 리눅스 시스템에서 디스크와 관련된 작업을 수행하려면 먼저 디스크의 장치 이름부터 알아야 함
- 컨트롤러에 연결되는 디스크의 순서에 따라 이름에 알파벳이 추가되는 방식으로 부여
- 예를 들어 3개의 하드디스크를 추가하였다면
  1. /dev/sda
  2. /dev/sdb
  3. /dev/sdc
- 하나의 디스크를 여러 개의 파티션으로 구분하여 사용할 때의 파티션은 디스크 장치 이름 뒤에 숫자를 붙여서 표시
- 예를 들어 디스크의 이름이 /dev/sda라고 한다면 파티션의 이름은 다음과 같이 표시
  1. 첫 번째 파티션 /dev/sda => 디스크 장치 전체도 하나의 파티션임!
     - 그래서 처음에 `$ fdisk /dev/sda`로 진입한 후 d를 눌렀을 때 파티션이 없다고 나온 것
  2. 두 번째 파티션 /dev/sda0
  3. 세 번째 파티션 /dev/sda1

#### 2) 디스크 파티션 명령: fdisk

- `$ fdisk [옵션] [디스크 드라이브명]`
  - 디스크의 파티션을 생성, 삭제, 관리하는 명령
  - 새로 장착한 디스크는 fdisk 명령을 사용하여 파티션 작업을 수행
  - 시스템 관련 명령이기 때문에 관리자 계정으로 실행 필요
- 옵션
  - -l
    - 현재 설정되어 있는 파티션 정보 출력
- 내부명령
  - a
  - n
  - w
  - v



- SCSI
  - 스커지
  - 

### II. 파일 시스템 생성



### III. 디스크 마운트



### IV. 효율적 하드디스크 관리

- 리눅스 시스템은 여러 사용자가 동시에 접속하여 사용하기 때문에 디스크의 용량은 언제든지 부족한 현상이 발생할 수 있음
- 디스크 용량이 부족할 때는 여러 개의 하드디스크를 하나의 하드디스크처럼 사용할 수 있는 기능을 활용
- 기능별로 관리하는 것이 효율적인 관리



#### 1) LVM이란?

- Logical Volume Manager

- LVM을 사용하면 파티션이 부족할 경우 다른 파티션의 용량을 가져와 사용할 수 있음
- LVM을 이해하기 위해서는 먼저 LVM에서 사용되는 용어를 이해해야 함
  - 물리 볼륨(PG)
    - 실제 하드디스크의 파티션
  - 볼륨 그룹(VG)
    - 여러 개의 PV를 합쳐서 1개로 묶은 그룹
  - 논리 볼륨(LV)
    - VG를 1개 이상으로 적절한 크기로 나눈 파티션

- LVM을 구현할 때 진행되는 순서
  1. PG
  2. VG
  3. LV

- 개념 정도만 알아둘것



## 2. 파일시스템 검사 및 복구

### I. 파일시스템 검사방법

- 파일시스템의 검사는 부적절한 시스템의 종료 또는 전원의 불안정 및 기타 오류로 인해 손상된 파일시스템이 존재하는지를 검사
- 주기적인 파일시스템 검사를 통해 손상된 파일로 인해 시스템 전체에 발생할 수 있는 문제를 사전에 예방
- fsck 명령과 e2fsck 명령을 사용하여 파일시스템을 검사

### II. FSCK 명령으로 파일시스템 검사

- fsck 명령은 file system check의 약어로 디렉토리와 파일, I-node와 블록, 파일 링크 등을 검사하고 필요한 경우 복구작업도 수행
- 이 명령은 /etc/fstab에 지정된 파일시스템을 대상으로 명령을 수행
- fsck 명령



### III. 배드 블록 검사

- 블록
  - 데이터가 저장되는 공간

- 정전 등의 이유로 컴퓨터의 전원이 갑작스럽게 꺼지는 등의 비정상적인 시스템 구동으로 배드 블록 발생
- 배드 블록은 디스크에 심각한 오류와 데이터의 치명적인 피해를 유발할 수 있으므로 주기적으로 배드 블록 검사가 필요함

#### 1) 배드 블록 검사 명령: badblocks

- `$ badblocks [옵션] 디스크 장치명`

- 디스크 장치의 배드 블록을 검사

- 옵션
  - `-v`
    - 검사결과를 상세하게 출력
  - `-o 출력파일`
    - 검사한 배드 블록 목록을 지정한 출력파일에 저장

### IV. 파일시스템 복구

- 만약 파일시스템의 기본 슈퍼블록에 문제가 있을 경우에는 해당 파일시스템을 정상적으로 사용하는 것이 불가
- 리눅스 시스템에서는 이럴 경우를 대비해 백업 슈퍼블록을 제공하고 있으며 슈퍼블록에는 다음과 같은 다양한 정보가 저장되어 있음

#### 백업 슈퍼블록의 위치 확인 : dumpe2fs

`# dump2fs / devㅣ/sdb |grep superblock`

#### 파일시스템 복구하기: -b 옵션

- 파일시스템에 문제가 생겨서 정상적으로 사용할 수 없게 되면 백업 슈퍼블록을 이용하여 파일시스템을 복구